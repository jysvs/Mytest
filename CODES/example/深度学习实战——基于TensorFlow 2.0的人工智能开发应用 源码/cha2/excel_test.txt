# 引入外部参数读取模块argparse
from argparse import ArgumentParser
# 引入Excel表格读物模块xlrd和写入模块xlwt
import xlrd, xlwt

def get_data_path():
	"""获取表格所在路径
	参数：
		无
	返回：
		path：表格路径
	"""
    #./是怎么确定文件所在的位置？
	# 默认表格路径
    path_default = "./datas/datas_rw.xlsx"
    # 读取外部参数类
    # ArgumentParser命令行参数解析器
    parser = ArgumentParser()
    # 添加路径
    parser.add_argument("--path", default=path_default)
    # 存储路径参数函数
    args = parser.parse_args()
    # 获取路径
    path = args.path
    # 返回表格路径
    return path

def read_excel_data():
	"""读取Excel表格数据
	参数：
		无
	返回：
		无
	"""
	# 获取默认表格路径，format的用法？
    path = get_data_path()
    print("默认文件路径: {}".format(path))
    print("使用其路径可使用:python rw_excel.py --path 绝对路径")
    # 打开文档
    workbook = xlrd.open_workbook(path)
    # 表格名称,排序为文档表格自左向右
    sheet_names = workbook.sheet_names()
    # 表格名称: ['人员信息', '项目信息']
    print("表格名称: {}".format(sheet_names))
    # 表格对象,类型为list,遍历取对应表格的数据
    sheets = workbook.sheets()
    # 读取表格:人员信息sheets[0]
    user_info = sheets[0]
    # 表格名称
    user_info_name = user_info.name 
    print("user infomation table name: {}".format(user_info_name))
    # 人员信息表格:行数
    user_info_row_nums = user_info.nrows
    # 人员信息表格:列数
    user_info_col_nums = user_info.ncols
    print("user infomation table row number: {}, column nubmer: {}".format(user_info_row_nums, user_info_col_nums))
    # 表格整行内容
    row_num = 0
    user_info_rows = user_info.row_values(row_num)
    # first row contents: ['编号', '姓名', '项目']
    print("first row contents: {}".format(user_info_rows))
    # 表格整列内容
    col_num = 0
    user_info_cols = user_info.col_values(col_num)
    # first column contents: ['编号', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 
    # '11', '12', '13', '14', '15', '16', '17', '18', '19', '20']
    print("first column contents: {}".format(user_info_cols))
    # 获取单元格内容A1
    cell_A1 = user_info.cell(row_num,col_num).value
    print("A1 cell data: {}".format(cell_A1))
    # 获取整行内容
    one_row = user_info.row(row_num)
    # one row data: [text:'编号', text:'姓名', text:'项目']
    print("one row data: {}".format(one_row))
    # 获取行某列值
    one_row_value = user_info.row(row_num)[col_num].value 
    # one row value in  certain column: 编号
    print("one row value in  certain column: {}".format(one_row_value))
    # 获取整列内容
    one_col = user_info.col(col_num)
    # one column data: [text:'编号', text:'1', text:'2', text:'3', text:'4', 
    # text:'5', text:'6', text:'7', text:'8',
    # text:'9', text:'10', text:'11', text:'12', text:'13', text:'14', 
    # text:'15', text:'16', text:'17', text:'18', text:'19', text:'20']
    print("one column data: {}".format(one_col))
    # 获取整列内容的某一行数据
    one_col_value = user_info.col(col_num)[row_num].value
    # one column value in certain row: 编号
    print("one column value in certain row: {}".format(one_col_value))
    # 数据类型
    data_type = user_info.row_types(row_num)
    # data type: array('B', [1, 1, 1])
    print("data type: {}".format(data_type))

def write_data_to_excel_write_once():
    workbook = xlwt.Workbook()
    # 添加sheet，单元格只写入一次
    sheet = workbook.add_sheet("写入数据测试", cell_overwrite_ok=False)
    # 指定写入的行与列
        row_num = 0
        col_num = 0
    try:
            # 写入相应数据
            sheet.write(row_num, col_num, 25)
            sheet.write(row_num, col_num, 250) 
            # 保存数据
            workbook.save("rw_test.xlsx")
            print("process status: saved successfully!")
        except Exception:
            print("Permission Denied for rewrite data")

if __name__ == "__main__":
	# 读取表格内容
    read_excel_data()
    # 向Excel写入数据
	write_data_to_excel_write_once()
